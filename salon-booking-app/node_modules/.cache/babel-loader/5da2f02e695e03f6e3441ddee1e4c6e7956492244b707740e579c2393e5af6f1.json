{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\sumuka\\\\Desktop\\\\Backend Final Project\\\\Salon-Booking-App\\\\src\\\\components\\\\Home\\\\Feedback.js\",\n  _s = $RefreshSig$();\nimport { Container, Col, Row, Button, Form } from 'react-bootstrap';\nimport useFetch from '../../FetchUrl/useFetch';\nimport { useRef, useEffect } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\nimport { FaStar } from \"react-icons/fa6\";\nimport socket from '../../socket/socket';\nimport { servicesAction } from '../../store/servicesSlice';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FeedBack = ({\n  serviceId\n}) => {\n  _s();\n  const feedbackRef = useRef();\n  const dispatch = useDispatch();\n  useFetch({\n    url: `http://13.61.4.12:3000/salon-booking/getAllFeedBacks?serviceId=${serviceId}`,\n    method: 'GET',\n    body: null,\n    headers: {},\n    action: 'GET_FEEDBACKS'\n  });\n  useEffect(() => {\n    socket.emit('join-group', serviceId);\n    socket.on('incoming-reply', incomingData => {\n      console.log(incomingData);\n      dispatch(servicesAction.addFeedback(incomingData.data));\n    });\n    return () => {\n      socket.off('incoming-reply');\n    };\n  }, [serviceId]);\n  const feedbacks = useSelector(state => state.service.feedbacks);\n  console.log(feedbacks);\n  const submitReply = async (e, data) => {\n    e.preventDefault();\n    console.log(data);\n    const replyData = {\n      id: serviceId,\n      feedback: feedbackRef.current.value,\n      replyId: data.id\n    };\n    const result = await fetch('http://13.61.4.12:3000/salon-booking/sendFeedback', {\n      method: 'POST',\n      body: JSON.stringify(replyData),\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': localStorage.getItem('token'),\n        'Admin': localStorage.getItem('admin')\n      }\n    });\n    const dta = await result.json();\n    console.log(dta);\n    socket.emit('send-reply', dta);\n    dispatch(servicesAction.addFeedback(dta.data));\n  };\n  const groupFeedback = feedbacks.filter(feedback => feedback.replyId === null).map(feedback => {\n    const reply = feedbacks.filter(reply => reply.replyId === feedback.id);\n    return {\n      ...feedback,\n      reply\n    };\n  });\n  console.log(groupFeedback);\n  return /*#__PURE__*/_jsxDEV(Container, {\n    className: \"bg-secondary p-2 my-2\",\n    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"fs-4\",\n      children: \"Customer FeedBacks\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }, this), groupFeedback.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"fs-3 bg-light m-2 text-dark text-center\",\n      children: \"No Feedbacks Found\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 43\n    }, this), groupFeedback.length !== 0 && groupFeedback.map(feedback => /*#__PURE__*/_jsxDEV(Row, {\n      className: \"bg-light m-1 text-dark\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"fs-3 fw-bold\",\n        children: feedback.user.username\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: feedback.feedback\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-2 justify-content-between\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [...Array(5)].map((star, index) => /*#__PURE__*/_jsxDEV(FaStar, {\n            style: {\n              color: `${feedback.rating >= index + 1 ? 'yellow' : 'grey'}`\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 21\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this), feedback.reply && feedback.reply.map(reply => /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"fs-3 fw-bold\",\n            children: reply.user.username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: reply.feedback\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 21\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 18\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex  justify-content-end mb-2\",\n        children: /*#__PURE__*/_jsxDEV(Form, {\n          className: \"d-flex\",\n          onSubmit: e => submitReply(e, {\n            ...feedback\n          }),\n          children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"text\",\n            className: \"mx-2 border-secondary\",\n            ref: feedbackRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            className: \"bg-white text-dark border-secondary\",\n            type: \"submit\",\n            children: \"Reply\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 18\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 18\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 18\n      }, this)]\n    }, feedback.id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 71\n    }, this))]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 72,\n    columnNumber: 9\n  }, this);\n};\n_s(FeedBack, \"fYBRYxGscrZ/mDa44YdDwUljS0A=\", false, function () {\n  return [useDispatch, useFetch, useSelector];\n});\n_c = FeedBack;\nexport default FeedBack;\nvar _c;\n$RefreshReg$(_c, \"FeedBack\");","map":{"version":3,"names":["Container","Col","Row","Button","Form","useFetch","useRef","useEffect","useSelector","useDispatch","FaStar","socket","servicesAction","jsxDEV","_jsxDEV","FeedBack","serviceId","_s","feedbackRef","dispatch","url","method","body","headers","action","emit","on","incomingData","console","log","addFeedback","data","off","feedbacks","state","service","submitReply","e","preventDefault","replyData","id","feedback","current","value","replyId","result","fetch","JSON","stringify","localStorage","getItem","dta","json","groupFeedback","filter","map","reply","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","user","username","Array","star","index","style","color","rating","onSubmit","Control","type","ref","_c","$RefreshReg$"],"sources":["C:/Users/sumuka/Desktop/Backend Final Project/Salon-Booking-App/src/components/Home/Feedback.js"],"sourcesContent":["\r\nimport {Container,Col,Row,Button,Form} from 'react-bootstrap'\r\nimport useFetch from '../../FetchUrl/useFetch'\r\nimport {useRef,useEffect} from 'react'\r\nimport {useSelector,useDispatch} from 'react-redux'\r\nimport { FaStar } from \"react-icons/fa6\";\r\nimport socket from'../../socket/socket'\r\nimport {servicesAction} from '../../store/servicesSlice'\r\n\r\nconst FeedBack=({serviceId})=>{\r\nconst feedbackRef=useRef()\r\nconst dispatch=useDispatch()\r\n    useFetch({\r\n        url:`http://13.61.4.12:3000/salon-booking/getAllFeedBacks?serviceId=${serviceId}`,\r\n        method:'GET',\r\n        body:null,\r\n        headers:{\r\n\r\n        },\r\n        action:'GET_FEEDBACKS'\r\n    })\r\n\r\n    useEffect(()=>{\r\n        socket.emit('join-group',serviceId)\r\n        \r\n\r\n        socket.on('incoming-reply',(incomingData)=>{\r\n            console.log(incomingData)\r\n            dispatch(servicesAction.addFeedback(incomingData.data))\r\n        })\r\n\r\n        return ()=>{\r\n            socket.off('incoming-reply')\r\n        }\r\n    },[serviceId])\r\n\r\n    const feedbacks=useSelector(state=>state.service.feedbacks)\r\n    console.log(feedbacks)\r\n\r\n    const submitReply=async(e,data)=>{\r\n        e.preventDefault()\r\n        console.log(data)\r\n\r\n        const replyData={\r\n            id:serviceId,\r\n            feedback:feedbackRef.current.value,\r\n            replyId:data.id\r\n        }\r\n       \r\n           \r\n            const result=await fetch('http://13.61.4.12:3000/salon-booking/sendFeedback',{\r\n             method:'POST',\r\n             body:JSON.stringify(replyData), \r\n             headers:{\r\n               'Content-Type':'application/json',\r\n               'Authorization':localStorage.getItem('token') ,\r\n               'Admin':localStorage.getItem('admin')\r\n             }\r\n           })\r\n           const dta=await result.json()\r\n           console.log(dta)\r\n           socket.emit('send-reply',dta)\r\n          dispatch(servicesAction.addFeedback(dta.data))\r\n           \r\n    }\r\n   const groupFeedback=feedbacks.filter(feedback=>feedback.replyId===null).map((feedback=>{\r\n        const reply=feedbacks.filter((reply)=>reply.replyId===feedback.id)\r\n        return {...feedback,reply}\r\n    }))\r\n    console.log(groupFeedback)\r\n    return(\r\n        <Container className='bg-secondary p-2 my-2'>\r\n            <p className='fs-4'>Customer FeedBacks</p>\r\n            { groupFeedback.length===0 && <p className='fs-3 bg-light m-2 text-dark text-center'>No Feedbacks Found</p>}\r\n            { groupFeedback.length!==0 && groupFeedback.map(feedback=><Row className='bg-light m-1 text-dark' key={feedback.id}>\r\n                 <p className='fs-3 fw-bold'>{feedback.user.username}</p>\r\n                 <p>{feedback.feedback}</p>\r\n                 <div className='mb-2 justify-content-between'>\r\n                    <div>\r\n                 {[...Array(5)].map((star,index)=>\r\n                    <FaStar style={{color:`${feedback.rating>=(index+1)?'yellow':'grey'}`}}/>\r\n                 )}\r\n                 </div>\r\n                 {feedback.reply && feedback.reply.map(reply=>\r\n                    <Row >\r\n                        <p className='fs-3 fw-bold'>{reply.user.username}</p>\r\n                        <p>{reply.feedback}</p>\r\n                    </Row>\r\n                 )}\r\n                 \r\n                 </div>\r\n                 <div className='d-flex  justify-content-end mb-2'>\r\n                 <Form className='d-flex' onSubmit={(e)=>submitReply(e,{...feedback})}>\r\n                    <Form.Control type='text' className='mx-2 border-secondary' ref={feedbackRef}/>\r\n                 <Button className='bg-white text-dark border-secondary' type='submit'>Reply</Button>\r\n                 </Form>\r\n                </div>\r\n            </Row>)}\r\n            </Container>\r\n    )\r\n}\r\n\r\nexport default FeedBack"],"mappings":";;AACA,SAAQA,SAAS,EAACC,GAAG,EAACC,GAAG,EAACC,MAAM,EAACC,IAAI,QAAO,iBAAiB;AAC7D,OAAOC,QAAQ,MAAM,yBAAyB;AAC9C,SAAQC,MAAM,EAACC,SAAS,QAAO,OAAO;AACtC,SAAQC,WAAW,EAACC,WAAW,QAAO,aAAa;AACnD,SAASC,MAAM,QAAQ,iBAAiB;AACxC,OAAOC,MAAM,MAAK,qBAAqB;AACvC,SAAQC,cAAc,QAAO,2BAA2B;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAExD,MAAMC,QAAQ,GAACA,CAAC;EAACC;AAAS,CAAC,KAAG;EAAAC,EAAA;EAC9B,MAAMC,WAAW,GAACZ,MAAM,CAAC,CAAC;EAC1B,MAAMa,QAAQ,GAACV,WAAW,CAAC,CAAC;EACxBJ,QAAQ,CAAC;IACLe,GAAG,EAAC,kEAAkEJ,SAAS,EAAE;IACjFK,MAAM,EAAC,KAAK;IACZC,IAAI,EAAC,IAAI;IACTC,OAAO,EAAC,CAER,CAAC;IACDC,MAAM,EAAC;EACX,CAAC,CAAC;EAEFjB,SAAS,CAAC,MAAI;IACVI,MAAM,CAACc,IAAI,CAAC,YAAY,EAACT,SAAS,CAAC;IAGnCL,MAAM,CAACe,EAAE,CAAC,gBAAgB,EAAEC,YAAY,IAAG;MACvCC,OAAO,CAACC,GAAG,CAACF,YAAY,CAAC;MACzBR,QAAQ,CAACP,cAAc,CAACkB,WAAW,CAACH,YAAY,CAACI,IAAI,CAAC,CAAC;IAC3D,CAAC,CAAC;IAEF,OAAO,MAAI;MACPpB,MAAM,CAACqB,GAAG,CAAC,gBAAgB,CAAC;IAChC,CAAC;EACL,CAAC,EAAC,CAAChB,SAAS,CAAC,CAAC;EAEd,MAAMiB,SAAS,GAACzB,WAAW,CAAC0B,KAAK,IAAEA,KAAK,CAACC,OAAO,CAACF,SAAS,CAAC;EAC3DL,OAAO,CAACC,GAAG,CAACI,SAAS,CAAC;EAEtB,MAAMG,WAAW,GAAC,MAAAA,CAAMC,CAAC,EAACN,IAAI,KAAG;IAC7BM,CAAC,CAACC,cAAc,CAAC,CAAC;IAClBV,OAAO,CAACC,GAAG,CAACE,IAAI,CAAC;IAEjB,MAAMQ,SAAS,GAAC;MACZC,EAAE,EAACxB,SAAS;MACZyB,QAAQ,EAACvB,WAAW,CAACwB,OAAO,CAACC,KAAK;MAClCC,OAAO,EAACb,IAAI,CAACS;IACjB,CAAC;IAGG,MAAMK,MAAM,GAAC,MAAMC,KAAK,CAAC,mDAAmD,EAAC;MAC5EzB,MAAM,EAAC,MAAM;MACbC,IAAI,EAACyB,IAAI,CAACC,SAAS,CAACT,SAAS,CAAC;MAC9BhB,OAAO,EAAC;QACN,cAAc,EAAC,kBAAkB;QACjC,eAAe,EAAC0B,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;QAC7C,OAAO,EAACD,YAAY,CAACC,OAAO,CAAC,OAAO;MACtC;IACF,CAAC,CAAC;IACF,MAAMC,GAAG,GAAC,MAAMN,MAAM,CAACO,IAAI,CAAC,CAAC;IAC7BxB,OAAO,CAACC,GAAG,CAACsB,GAAG,CAAC;IAChBxC,MAAM,CAACc,IAAI,CAAC,YAAY,EAAC0B,GAAG,CAAC;IAC9BhC,QAAQ,CAACP,cAAc,CAACkB,WAAW,CAACqB,GAAG,CAACpB,IAAI,CAAC,CAAC;EAEpD,CAAC;EACF,MAAMsB,aAAa,GAACpB,SAAS,CAACqB,MAAM,CAACb,QAAQ,IAAEA,QAAQ,CAACG,OAAO,KAAG,IAAI,CAAC,CAACW,GAAG,CAAEd,QAAQ,IAAE;IAClF,MAAMe,KAAK,GAACvB,SAAS,CAACqB,MAAM,CAAEE,KAAK,IAAGA,KAAK,CAACZ,OAAO,KAAGH,QAAQ,CAACD,EAAE,CAAC;IAClE,OAAO;MAAC,GAAGC,QAAQ;MAACe;IAAK,CAAC;EAC9B,CAAE,CAAC;EACH5B,OAAO,CAACC,GAAG,CAACwB,aAAa,CAAC;EAC1B,oBACIvC,OAAA,CAACd,SAAS;IAACyD,SAAS,EAAC,uBAAuB;IAAAC,QAAA,gBACxC5C,OAAA;MAAG2C,SAAS,EAAC,MAAM;MAAAC,QAAA,EAAC;IAAkB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,EACxCT,aAAa,CAACU,MAAM,KAAG,CAAC,iBAAIjD,OAAA;MAAG2C,SAAS,EAAC,yCAAyC;MAAAC,QAAA,EAAC;IAAkB;MAAAC,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CAAC,EACzGT,aAAa,CAACU,MAAM,KAAG,CAAC,IAAIV,aAAa,CAACE,GAAG,CAACd,QAAQ,iBAAE3B,OAAA,CAACZ,GAAG;MAACuD,SAAS,EAAC,wBAAwB;MAAAC,QAAA,gBAC5F5C,OAAA;QAAG2C,SAAS,EAAC,cAAc;QAAAC,QAAA,EAAEjB,QAAQ,CAACuB,IAAI,CAACC;MAAQ;QAAAN,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACxDhD,OAAA;QAAA4C,QAAA,EAAIjB,QAAQ,CAACA;MAAQ;QAAAkB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC1BhD,OAAA;QAAK2C,SAAS,EAAC,8BAA8B;QAAAC,QAAA,gBAC1C5C,OAAA;UAAA4C,QAAA,EACF,CAAC,GAAGQ,KAAK,CAAC,CAAC,CAAC,CAAC,CAACX,GAAG,CAAC,CAACY,IAAI,EAACC,KAAK,kBAC3BtD,OAAA,CAACJ,MAAM;YAAC2D,KAAK,EAAE;cAACC,KAAK,EAAC,GAAG7B,QAAQ,CAAC8B,MAAM,IAAGH,KAAK,GAAC,CAAE,GAAC,QAAQ,GAAC,MAAM;YAAE;UAAE;YAAAT,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAC3E;QAAC;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACI,CAAC,EACLrB,QAAQ,CAACe,KAAK,IAAIf,QAAQ,CAACe,KAAK,CAACD,GAAG,CAACC,KAAK,iBACxC1C,OAAA,CAACZ,GAAG;UAAAwD,QAAA,gBACA5C,OAAA;YAAG2C,SAAS,EAAC,cAAc;YAAAC,QAAA,EAAEF,KAAK,CAACQ,IAAI,CAACC;UAAQ;YAAAN,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC,eACrDhD,OAAA;YAAA4C,QAAA,EAAIF,KAAK,CAACf;UAAQ;YAAAkB,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAI,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACtB,CACR,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAEI,CAAC,eACNhD,OAAA;QAAK2C,SAAS,EAAC,kCAAkC;QAAAC,QAAA,eACjD5C,OAAA,CAACV,IAAI;UAACqD,SAAS,EAAC,QAAQ;UAACe,QAAQ,EAAGnC,CAAC,IAAGD,WAAW,CAACC,CAAC,EAAC;YAAC,GAAGI;UAAQ,CAAC,CAAE;UAAAiB,QAAA,gBAClE5C,OAAA,CAACV,IAAI,CAACqE,OAAO;YAACC,IAAI,EAAC,MAAM;YAACjB,SAAS,EAAC,uBAAuB;YAACkB,GAAG,EAAEzD;UAAY;YAAAyC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAC,CAAC,eAClFhD,OAAA,CAACX,MAAM;YAACsD,SAAS,EAAC,qCAAqC;YAACiB,IAAI,EAAC,QAAQ;YAAAhB,QAAA,EAAC;UAAK;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAQ,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAC9E;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACH,CAAC;IAAA,GAtB6FrB,QAAQ,CAACD,EAAE;MAAAmB,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAuB7G,CAAC,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACI,CAAC;AAExB,CAAC;AAAA7C,EAAA,CA3FKF,QAAQ;EAAA,QAECN,WAAW,EACtBJ,QAAQ,EAwBQG,WAAW;AAAA;AAAAoE,EAAA,GA3BzB7D,QAAQ;AA6Fd,eAAeA,QAAQ;AAAA,IAAA6D,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}