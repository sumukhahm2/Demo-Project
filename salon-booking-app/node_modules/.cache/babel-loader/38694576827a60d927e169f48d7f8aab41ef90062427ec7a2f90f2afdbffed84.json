{"ast":null,"code":"import _objectSpread from\"C:/Users/sumuka/Desktop/Backend Final Project/salon-booking-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{Container,Col,Row,Button,Form}from'react-bootstrap';import useFetch from'../../FetchUrl/useFetch';import{useRef,useEffect}from'react';import{useSelector,useDispatch}from'react-redux';import{FaStar}from\"react-icons/fa6\";import socket from'../../socket/socket';import{servicesAction}from'../../store/servicesSlice';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const FeedBack=_ref=>{let{serviceId}=_ref;const feedbackRef=useRef();const dispatch=useDispatch();useFetch({url:\"http://13.61.4.12:3000/salon-booking/getAllFeedBacks?serviceId=\".concat(serviceId),method:'GET',body:null,headers:{},action:'GET_FEEDBACKS'});useEffect(()=>{socket.emit('join-group',serviceId);socket.on('incoming-reply',incomingData=>{console.log(incomingData);dispatch(servicesAction.addFeedback(incomingData.data));});return()=>{socket.off('incoming-reply');};},[serviceId]);const feedbacks=useSelector(state=>state.service.feedbacks);console.log(feedbacks);const submitReply=async(e,data)=>{e.preventDefault();console.log(data);const replyData={id:serviceId,feedback:feedbackRef.current.value,replyId:data.id};const result=await fetch('http://13.61.4.12:3000/salon-booking/sendFeedback',{method:'POST',body:JSON.stringify(replyData),headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token'),'Admin':localStorage.getItem('admin')}});const dta=await result.json();console.log(dta);socket.emit('send-reply',dta);dispatch(servicesAction.addFeedback(dta.data));};const groupFeedback=feedbacks.filter(feedback=>feedback.replyId===null).map(feedback=>{const reply=feedbacks.filter(reply=>reply.replyId===feedback.id);return _objectSpread(_objectSpread({},feedback),{},{reply});});console.log(groupFeedback);return/*#__PURE__*/_jsxs(Container,{className:\"bg-secondary p-2 my-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"fs-4\",children:\"Customer FeedBacks\"}),groupFeedback.length===0&&/*#__PURE__*/_jsx(\"p\",{className:\"fs-3 bg-light m-2 text-dark text-center\",children:\"No Feedbacks Found\"}),groupFeedback.length!==0&&groupFeedback.map(feedback=>/*#__PURE__*/_jsxs(Row,{className:\"bg-light m-1 text-dark\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"fs-3 fw-bold\",children:feedback.user.username}),/*#__PURE__*/_jsx(\"p\",{children:feedback.feedback}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2 justify-content-between\",children:[/*#__PURE__*/_jsx(\"div\",{children:[...Array(5)].map((star,index)=>/*#__PURE__*/_jsx(FaStar,{style:{color:\"\".concat(feedback.rating>=index+1?'yellow':'grey')}}))}),feedback.reply&&feedback.reply.map(reply=>/*#__PURE__*/_jsxs(Row,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"fs-3 fw-bold\",children:reply.user.username}),/*#__PURE__*/_jsx(\"p\",{children:reply.feedback})]}))]}),/*#__PURE__*/_jsx(\"div\",{className:\"d-flex  justify-content-end mb-2\",children:/*#__PURE__*/_jsxs(Form,{className:\"d-flex\",onSubmit:e=>submitReply(e,_objectSpread({},feedback)),children:[/*#__PURE__*/_jsx(Form.Control,{type:\"text\",className:\"mx-2 border-secondary\",ref:feedbackRef}),/*#__PURE__*/_jsx(Button,{className:\"bg-white text-dark border-secondary\",type:\"submit\",children:\"Reply\"})]})})]},feedback.id))]});};export default FeedBack;","map":{"version":3,"names":["Container","Col","Row","Button","Form","useFetch","useRef","useEffect","useSelector","useDispatch","FaStar","socket","servicesAction","jsx","_jsx","jsxs","_jsxs","FeedBack","_ref","serviceId","feedbackRef","dispatch","url","concat","method","body","headers","action","emit","on","incomingData","console","log","addFeedback","data","off","feedbacks","state","service","submitReply","e","preventDefault","replyData","id","feedback","current","value","replyId","result","fetch","JSON","stringify","localStorage","getItem","dta","json","groupFeedback","filter","map","reply","_objectSpread","className","children","length","user","username","Array","star","index","style","color","rating","onSubmit","Control","type","ref"],"sources":["C:/Users/sumuka/Desktop/Backend Final Project/Salon-Booking-App/src/components/Home/Feedback.js"],"sourcesContent":["\r\nimport {Container,Col,Row,Button,Form} from 'react-bootstrap'\r\nimport useFetch from '../../FetchUrl/useFetch'\r\nimport {useRef,useEffect} from 'react'\r\nimport {useSelector,useDispatch} from 'react-redux'\r\nimport { FaStar } from \"react-icons/fa6\";\r\nimport socket from'../../socket/socket'\r\nimport {servicesAction} from '../../store/servicesSlice'\r\n\r\nconst FeedBack=({serviceId})=>{\r\nconst feedbackRef=useRef()\r\nconst dispatch=useDispatch()\r\n    useFetch({\r\n        url:`http://13.61.4.12:3000/salon-booking/getAllFeedBacks?serviceId=${serviceId}`,\r\n        method:'GET',\r\n        body:null,\r\n        headers:{\r\n\r\n        },\r\n        action:'GET_FEEDBACKS'\r\n    })\r\n\r\n    useEffect(()=>{\r\n        socket.emit('join-group',serviceId)\r\n        \r\n\r\n        socket.on('incoming-reply',(incomingData)=>{\r\n            console.log(incomingData)\r\n            dispatch(servicesAction.addFeedback(incomingData.data))\r\n        })\r\n\r\n        return ()=>{\r\n            socket.off('incoming-reply')\r\n        }\r\n    },[serviceId])\r\n\r\n    const feedbacks=useSelector(state=>state.service.feedbacks)\r\n    console.log(feedbacks)\r\n\r\n    const submitReply=async(e,data)=>{\r\n        e.preventDefault()\r\n        console.log(data)\r\n\r\n        const replyData={\r\n            id:serviceId,\r\n            feedback:feedbackRef.current.value,\r\n            replyId:data.id\r\n        }\r\n       \r\n           \r\n            const result=await fetch('http://13.61.4.12:3000/salon-booking/sendFeedback',{\r\n             method:'POST',\r\n             body:JSON.stringify(replyData), \r\n             headers:{\r\n               'Content-Type':'application/json',\r\n               'Authorization':localStorage.getItem('token') ,\r\n               'Admin':localStorage.getItem('admin')\r\n             }\r\n           })\r\n           const dta=await result.json()\r\n           console.log(dta)\r\n           socket.emit('send-reply',dta)\r\n          dispatch(servicesAction.addFeedback(dta.data))\r\n           \r\n    }\r\n   const groupFeedback=feedbacks.filter(feedback=>feedback.replyId===null).map((feedback=>{\r\n        const reply=feedbacks.filter((reply)=>reply.replyId===feedback.id)\r\n        return {...feedback,reply}\r\n    }))\r\n    console.log(groupFeedback)\r\n    return(\r\n        <Container className='bg-secondary p-2 my-2'>\r\n            <p className='fs-4'>Customer FeedBacks</p>\r\n            { groupFeedback.length===0 && <p className='fs-3 bg-light m-2 text-dark text-center'>No Feedbacks Found</p>}\r\n            { groupFeedback.length!==0 && groupFeedback.map(feedback=><Row className='bg-light m-1 text-dark' key={feedback.id}>\r\n                 <p className='fs-3 fw-bold'>{feedback.user.username}</p>\r\n                 <p>{feedback.feedback}</p>\r\n                 <div className='mb-2 justify-content-between'>\r\n                    <div>\r\n                 {[...Array(5)].map((star,index)=>\r\n                    <FaStar style={{color:`${feedback.rating>=(index+1)?'yellow':'grey'}`}}/>\r\n                 )}\r\n                 </div>\r\n                 {feedback.reply && feedback.reply.map(reply=>\r\n                    <Row >\r\n                        <p className='fs-3 fw-bold'>{reply.user.username}</p>\r\n                        <p>{reply.feedback}</p>\r\n                    </Row>\r\n                 )}\r\n                 \r\n                 </div>\r\n                 <div className='d-flex  justify-content-end mb-2'>\r\n                 <Form className='d-flex' onSubmit={(e)=>submitReply(e,{...feedback})}>\r\n                    <Form.Control type='text' className='mx-2 border-secondary' ref={feedbackRef}/>\r\n                 <Button className='bg-white text-dark border-secondary' type='submit'>Reply</Button>\r\n                 </Form>\r\n                </div>\r\n            </Row>)}\r\n            </Container>\r\n    )\r\n}\r\n\r\nexport default FeedBack"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}