{"ast":null,"code":"import _objectSpread from\"C:/Users/sumuka/Desktop/Backend Final Project/salon-booking-app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{Container,Row,Col,Button}from'react-bootstrap';import{useSelector,useDispatch}from'react-redux';import useFetch from'../../FetchUrl/useFetch';import{useState}from'react';import Calendar from'./Calendar';import{servicesAction}from'../../store/servicesSlice';import socket from'../../socket/socket';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const UserAppointments=()=>{const[isCalendar,setCalendar]=useState(false);const[isDownload,setDownload]=useState(null);const dispatch=useDispatch();const[fetchUrl,setUrl]=useState({url:'http://13.61.4.12:3000/salon-booking/getnotification',method:'GET',body:null,headers:{'Authorization':localStorage.getItem('token'),'Admin':localStorage.getItem('admin')},action:'GET_NOTIFICATIONS'});useFetch(fetchUrl);const submitData=async data=>{console.log(data);const response=await fetch('http://13.61.4.12:3000/salon-booking/reschedule-appointment',{method:'POST',body:JSON.stringify(data),headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token'),'Admin':localStorage.getItem('admin')}});const dta=await response.json();console.log(dta);if(dta.message){dispatch(servicesAction.updateNotification({id:data.id,status:'Reschedule',date:data.date,time:data.time}));socket.emit('reschedule-appointment',dta.data);alert(dta.message);}else alert(dta.error);};const generateInvoice=async id=>{const response=await fetch(\"http://13.61.4.12:3000/salon-booking/getinvoice?appointmentId=\".concat(id),{method:'GET',body:null,headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token'),'Admin':localStorage.getItem('admin')}});console.log(response);const dta=await response.json();console.log(dta);setDownload(dta.message.invoiceURL);document.getElementById('download').click();};const cancelAppointment=async data=>{console.log(data);const response=await fetch('http://13.51.199.15:3000/salon-booking/reschedule-appointment',{method:'POST',body:JSON.stringify(data),headers:{'Content-Type':'application/json','Authorization':localStorage.getItem('token'),'Admin':localStorage.getItem('admin')}});const dta=await response.json();console.log(dta);if(dta.message){dispatch(servicesAction.updateNotification(data));socket.emit('cancel-appointment',data);alert(dta.message);}else alert(dta.error);};const appointments=useSelector(state=>state.service.notifications);console.log(appointments);return/*#__PURE__*/_jsxs(Container,{className:\"mt-5\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"fs-2\",children:\"Booked Appointments\"}),appointments.length&&appointments.map(appt=>/*#__PURE__*/_jsxs(Row,{className:\"bg-light mb-2 text-dark d-flex\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[appt.status==='Success'&&/*#__PURE__*/_jsxs(\"p\",{className:\"fs-5 fw-bolder\",children:[\"Your Appointment for \",appt.appointmentname,\" has been Booked with Staf \",appt.stafname,\" on \",appt.date.split('T')[0],\" \",appt.time]}),appt.status==='Pending'&&/*#__PURE__*/_jsxs(\"p\",{className:\"fs-5 fw-bolder\",children:[\"Your Appointment for \",appt.appointmentname,\" has been  Booked on \",appt.date.split('T')[0],\" \",appt.time,\" and staf allotment need to be done \"]}),appt.status==='Canceled'&&/*#__PURE__*/_jsxs(\"p\",{className:\"fs-5 fw-bolder\",children:[\"Your Appointment for \",appt.appointmentname,\" has been  Canceled \"]})]}),appt.status!=='Canceled'&&/*#__PURE__*/_jsxs(\"div\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(Button,{className:\"mx-2 bg-warning\",onClick:()=>setCalendar(appt.id),children:\"Reschedule\"}),/*#__PURE__*/_jsx(Button,{className:\"bg-danger mx-2\",onClick:()=>cancelAppointment({id:appt.id,status:'Canceled'}),children:\"Cancel Appointment\"}),appt.status==='Success'&&/*#__PURE__*/_jsx(Button,{onClick:()=>generateInvoice(appt.id),children:\"Generate Invoice\"}),appt.status==='Success'&&/*#__PURE__*/_jsx(\"a\",{id:\"download\",className:\"d-none\",target:\"_blank\",download:\"MyExampleDoc\",href:isDownload})]}),isCalendar===appt.id&&/*#__PURE__*/_jsx(Calendar,{returnData:data=>submitData(_objectSpread(_objectSpread({},data),{},{status:appt.status,id:appt.id})),onCancel:()=>{setCalendar(null);},reschedule:appt})]},appt.id))]});};export default UserAppointments;","map":{"version":3,"names":["Container","Row","Col","Button","useSelector","useDispatch","useFetch","useState","Calendar","servicesAction","socket","jsx","_jsx","jsxs","_jsxs","UserAppointments","isCalendar","setCalendar","isDownload","setDownload","dispatch","fetchUrl","setUrl","url","method","body","headers","localStorage","getItem","action","submitData","data","console","log","response","fetch","JSON","stringify","dta","json","message","updateNotification","id","status","date","time","emit","alert","error","generateInvoice","concat","invoiceURL","document","getElementById","click","cancelAppointment","appointments","state","service","notifications","className","children","length","map","appt","appointmentname","stafname","split","onClick","target","download","href","returnData","_objectSpread","onCancel","reschedule"],"sources":["C:/Users/sumuka/Desktop/Backend Final Project/Salon-Booking-App/src/components/Home/UserAppointment.js"],"sourcesContent":["\r\nimport {Container,Row,Col,Button} from 'react-bootstrap'\r\nimport {useSelector,useDispatch} from 'react-redux' \r\nimport useFetch from '../../FetchUrl/useFetch'\r\nimport {useState} from 'react'\r\nimport Calendar from './Calendar'\r\nimport {servicesAction} from '../../store/servicesSlice'\r\nimport socket from '../../socket/socket'\r\nconst UserAppointments=()=>{\r\n  const [isCalendar,setCalendar]=useState(false)\r\n  const [isDownload,setDownload]=useState(null)\r\n  const dispatch=useDispatch()\r\n  const [fetchUrl,setUrl]=useState({\r\n    url:'http://13.61.4.12:3000/salon-booking/getnotification',\r\n    method:'GET',\r\n    body:null,\r\n    headers:{\r\n        'Authorization':localStorage.getItem('token'),\r\n        'Admin':localStorage.getItem('admin')\r\n    },\r\n    action:'GET_NOTIFICATIONS'\r\n})\r\n    useFetch(fetchUrl)\r\n\r\n    const submitData=async(data)=>{\r\n     console.log(data)\r\n      \r\n        const response=await fetch('http://13.61.4.12:3000/salon-booking/reschedule-appointment',{\r\n        method:'POST',\r\n        body:JSON.stringify(data),\r\n        headers:{\r\n            'Content-Type':'application/json',\r\n            'Authorization':localStorage.getItem('token'),\r\n            'Admin':localStorage.getItem('admin')\r\n        },\r\n    })\r\n    const dta=await response.json()\r\n    console.log(dta)\r\n    if(dta.message)\r\n    {\r\n        dispatch(servicesAction.updateNotification({id:data.id,status:'Reschedule',date:data.date,time:data.time}))\r\n        socket.emit('reschedule-appointment',dta.data)\r\n        alert(dta.message)\r\n    }\r\n   \r\n    else\r\n     alert(dta.error)\r\n     \r\n\r\n    }\r\n\r\n    const generateInvoice=async(id)=>{\r\n        const response=await fetch(`http://13.61.4.12:3000/salon-booking/getinvoice?appointmentId=${id}`,{\r\n            method:'GET',\r\n            body:null,\r\n            headers:{\r\n                'Content-Type':'application/json',\r\n                'Authorization':localStorage.getItem('token'),\r\n                'Admin':localStorage.getItem('admin')\r\n            },\r\n        })\r\n        console.log(response)\r\n        const dta=await response.json()\r\n\r\n        console.log(dta)\r\n        setDownload(dta.message.invoiceURL)\r\n        document.getElementById('download').click()\r\n       \r\n    }\r\n\r\n    const cancelAppointment=async(data)=>{\r\n       console.log(data)\r\n       const response=await fetch('http://13.51.199.15:3000/salon-booking/reschedule-appointment',{\r\n        method:'POST',\r\n        body:JSON.stringify(data),\r\n        headers:{\r\n            'Content-Type':'application/json',\r\n            'Authorization':localStorage.getItem('token'),\r\n            'Admin':localStorage.getItem('admin')\r\n        },\r\n    })\r\n    const dta=await response.json()\r\n    console.log(dta)\r\n    if(dta.message)\r\n    {\r\n\r\n        \r\n        dispatch(servicesAction.updateNotification(data))\r\n        socket.emit('cancel-appointment',data)\r\n        alert(dta.message)\r\n    }\r\n    \r\n    else\r\n     alert(dta.error)\r\n     \r\n    }\r\n    const appointments=useSelector(state=>state.service.notifications)\r\n    console.log(appointments)\r\n   return(\r\n    <Container className='mt-5'>\r\n        <p className='fs-2'>Booked Appointments</p>\r\n          {appointments.length && appointments.map(appt=>\r\n          <Row key={appt.id} className='bg-light mb-2 text-dark d-flex'>\r\n            <div>\r\n            {appt.status==='Success' && <p className='fs-5 fw-bolder'>Your Appointment for {appt.appointmentname} has been Booked with Staf {appt.stafname} on {appt.date.split('T')[0]} {appt.time}</p>}\r\n            {appt.status==='Pending' && <p className='fs-5 fw-bolder'>Your Appointment for {appt.appointmentname} has been  Booked on {appt.date.split('T')[0]} {appt.time} and staf allotment need to be done </p>}\r\n            {appt.status==='Canceled' && <p className='fs-5 fw-bolder'>Your Appointment for {appt.appointmentname} has been  Canceled </p>}\r\n            </div>\r\n            {appt.status!=='Canceled' &&<div className='mb-2'>\r\n            <Button className='mx-2 bg-warning' onClick={()=>setCalendar(appt.id)}>Reschedule</Button>\r\n            <Button className='bg-danger mx-2' onClick={()=>cancelAppointment({id:appt.id,status:'Canceled'})}>Cancel Appointment</Button>\r\n           { appt.status==='Success' && <Button onClick={()=>generateInvoice(appt.id)}>Generate Invoice</Button>}\r\n           { appt.status==='Success' && <a id='download' className='d-none' target='_blank' download=\"MyExampleDoc\" href={isDownload}></a>}\r\n         \r\n            </div>}\r\n            {isCalendar===appt.id && <Calendar returnData={(data)=>submitData({...data,status:appt.status,id:appt.id})} onCancel={()=>{setCalendar(null)}} reschedule={appt}/>}\r\n          </Row>)}\r\n    </Container>\r\n   )\r\n}\r\n\r\nexport default UserAppointments"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}